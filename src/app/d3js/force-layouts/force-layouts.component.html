<div class="overall-wrapper" appMaximize #nestjsAuthGuards="maximize" id="nestjsAuthGuards">
    <div class="wrapper">
        <img class="swap" *ngIf="nestjsAuthGuards.checkfullscreen() == 'hide'" (click)="nestjsAuthGuards.toggle()" src="../../../assets/expand.svg" alt="Expand">
        <img class="swap" *ngIf="nestjsAuthGuards.checkfullscreen() != 'hide'" (click)="nestjsAuthGuards.toggle()" src="../../../assets/Minimize icon.svg" alt="Minimize">

        <div class="header">
            <p>
                <span class="question">What:</span>
                <strong>D3 Force Layouts</strong> use physics simulations to position nodes and links in network visualizations. They apply forces like gravity, repulsion, and attraction to create natural-looking layouts.
            </p>
            <p>
                <span class="question">Why:</span>
                Force layouts automatically handle complex positioning calculations, create organic-looking networks, support real-time interactions, and can adapt to dynamic data changes without manual coordinate management.
            </p>
            <p>
                <span class="question">Where:</span>
                Perfect for network diagrams, social graphs, organizational charts, dependency trees, clustering visualizations, and any data with relationships that benefit from physics-based positioning.
            </p>
        </div>
    </div>

    <div class="examples" id="examplesSection">
        <h3>D3 Force Layouts — Complete tutorial & examples</h3>

        <!-- Quick notes -->
        <div class="note">
            <p><strong>Quick setup:</strong> Force layouts require D3 v4+ with <code>d3.forceSimulation()</code>. Import with <code>import * as d3 from 'd3'</code> and create simulations that run over time.</p>
        </div>

        <!-- 1. Basic Force Simulation -->
        <div class="step">
            <h2>1. Basic Force Simulation — Simple Network</h2>
            <p>Start with a basic force simulation using the three essential forces: centering, many-body (repulsion), and links.</p>

       <pre><code>
<span class="keyword">private</span> <span class="keyword">createBasicSimulation</span>() : <span class="keyword">void</span> &#123;
    <span class="keyword">const</span> nodes: Node[] = [
        &#123; id: <span class="string">'A'</span>, group: <span class="number">1</span> &#125;,
        &#123; id: <span class="string">'B'</span>, group: <span class="number">1</span> &#125;,
        &#123; id: <span class="string">'C'</span>, group: <span class="number">2</span> &#125;,
        &#123; id: <span class="string">'D'</span>, group: <span class="number">2</span> &#125;,
        &#123; id: <span class="string">'E'</span>, group: <span class="number">3</span> &#125;
    ];

    <span class="keyword">const</span> links: Link[] = [
        &#123; source: <span class="string">'A'</span>, target: <span class="string">'B'</span> &#125;,
        &#123; source: <span class="string">'B'</span>, target: <span class="string">'C'</span> &#125;,
        &#123; source: <span class="string">'C'</span>, target: <span class="string">'D'</span> &#125;,
        &#123; source: <span class="string">'A'</span>, target: <span class="string">'D'</span> &#125;,
        &#123; source: <span class="string">'D'</span>, target: <span class="string">'E'</span> &#125;
    ];

    <span class="comment">// Create force simulation</span>
    this.simulation = d3.forceSimulation(nodes)
        .force(<span class="string">'link'</span>, d3.forceLink(links)
            .id((d: any) =&gt; d.id)
            .distance(<span class="number">60</span>))
        .force(<span class="string">'charge'</span>, d3.forceManyBody()
            .strength(-<span class="number">300</span>))
        .force(<span class="string">'center'</span>, d3.forceCenter(<span class="number">200</span>, <span class="number">100</span>));

    <span class="comment">// SVG setup</span>
    <span class="keyword">const</span> svg = d3.select(<span class="string">'#basic-force'</span>);
    svg.selectAll(<span class="string">'*'</span>).remove();

    <span class="comment">// Create links</span>
    <span class="keyword">const</span> link = svg.append(<span class="string">'g'</span>)
        .attr(<span class="string">'class'</span>, <span class="string">'links'</span>)
        .selectAll(<span class="string">'line'</span>)
        .data(links)
        .enter().append(<span class="string">'line'</span>)
        .attr(<span class="string">'stroke'</span>, <span class="string">'#999'</span>)
        .attr(<span class="string">'stroke-width'</span>, <span class="number">2</span>);

    <span class="comment">// Create nodes</span>
    <span class="keyword">const</span> node = svg.append(<span class="string">'g'</span>)
        .attr(<span class="string">'class'</span>, <span class="string">'nodes'</span>)
        .selectAll(<span class="string">'circle'</span>)
        .data(nodes)
        .enter().append(<span class="string">'circle'</span>)
        .attr(<span class="string">'r'</span>, <span class="number">15</span>)
        .attr(<span class="string">'fill'</span>, (d: any) =&gt; d3.schemeCategory10[d.group])
        .attr(<span class="string">'stroke'</span>, <span class="string">'white'</span>)
        .attr(<span class="string">'stroke-width'</span>, <span class="number">2</span>);

    <span class="comment">// Add labels</span>
    <span class="keyword">const</span> label = svg.append(<span class="string">'g'</span>)
        .attr(<span class="string">'class'</span>, <span class="string">'labels'</span>)
        .selectAll(<span class="string">'text'</span>)
        .data(nodes)
        .enter().append(<span class="string">'text'</span>)
        .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)
        .attr(<span class="string">'dy'</span>, <span class="number">4</span>)
        .attr(<span class="string">'font-size'</span>, <span class="string">'12px'</span>)
        .attr(<span class="string">'fill'</span>, <span class="string">'white'</span>)
        .text((d: any) =&gt; d.id);

    <span class="comment">// Update positions on simulation tick</span>
    this.simulation.on(<span class="string">'tick'</span>, () =&gt; &#123;
        link
            .attr(<span class="string">'x1'</span>, (d: any) =&gt; d.source.x)
            .attr(<span class="string">'y1'</span>, (d: any) =&gt; d.source.y)
            .attr(<span class="string">'x2'</span>, (d: any) =&gt; d.target.x)
            .attr(<span class="string">'y2'</span>, (d: any) =&gt; d.target.y);

        node
            .attr(<span class="string">'cx'</span>, (d: any) =&gt; d.x)
            .attr(<span class="string">'cy'</span>, (d: any) =&gt; d.y);

        label
            .attr(<span class="string">'x'</span>, (d: any) =&gt; d.x)
            .attr(<span class="string">'y'</span>, (d: any) =&gt; d.y);
    &#125;);
&#125;
</code></pre>


            <p><strong>Output:</strong></p>
            <svg id="basic-force" width="500" height="200" class="viz-container"></svg>
            <div class="controls">
                <button class="btn" (click)="restartBasicSimulation()">Restart Simulation</button>
            </div>
        </div>

        <!-- 2. Interactive Drag & Drop -->
        <div class="step">
            <h2>2. Interactive Drag & Drop — User Control</h2>
            <p>Add drag functionality to let users manually position nodes while forces continue to apply.</p>

        <pre><code>
<span class="keyword">private</span> <span class="keyword">createDragSimulation</span>() : <span class="keyword">void</span> &#123;
    <span class="comment">// Drag event handlers</span>
    <span class="keyword">const</span> dragstarted = (event: any, d: any) =&gt; &#123;
        <span class="keyword">if</span> (!event.active) this.simulation2.alphaTarget(<span class="number">0.3</span>).restart();
        d.fx = d.x;
        d.fy = d.y;
    &#125;;

    <span class="keyword">const</span> dragged = (event: any, d: any) =&gt; &#123;
        d.fx = event.x;
        d.fy = event.y;
    &#125;;

    <span class="keyword">const</span> dragended = (event: any, d: any) =&gt; &#123;
        <span class="keyword">if</span> (!event.active) this.simulation2.alphaTarget(<span class="number">0</span>);
        d.fx = <span class="keyword">null</span>;
        d.fy = <span class="keyword">null</span>;
    &#125;;

    <span class="comment">// Nodes</span>
    <span class="keyword">const</span> nodes2: Node[] = [
        &#123; id: <span class="string">'Central'</span>, group: <span class="number">1</span>, size: <span class="number">20</span> &#125;,
        &#123; id: <span class="string">'Node1'</span>, group: <span class="number">2</span>, size: <span class="number">15</span> &#125;,
        &#123; id: <span class="string">'Node2'</span>, group: <span class="number">2</span>, size: <span class="number">15</span> &#125;,
        &#123; id: <span class="string">'Node3'</span>, group: <span class="number">3</span>, size: <span class="number">12</span> &#125;,
        &#123; id: <span class="string">'Node4'</span>, group: <span class="number">3</span>, size: <span class="number">12</span> &#125;,
        &#123; id: <span class="string">'Node5'</span>, group: <span class="number">3</span>, size: <span class="number">10</span> &#125;
    ];

    <span class="comment">// Links</span>
    <span class="keyword">const</span> links2: Link[] = [
        &#123; source: <span class="string">'Central'</span>, target: <span class="string">'Node1'</span>, strength: <span class="number">1</span> &#125;,
        &#123; source: <span class="string">'Central'</span>, target: <span class="string">'Node2'</span>, strength: <span class="number">1</span> &#125;,
        &#123; source: <span class="string">'Node1'</span>, target: <span class="string">'Node3'</span>, strength: <span class="number">0.5</span> &#125;,
        &#123; source: <span class="string">'Node2'</span>, target: <span class="string">'Node4'</span>, strength: <span class="number">0.5</span> &#125;,
        &#123; source: <span class="string">'Node3'</span>, target: <span class="string">'Node5'</span>, strength: <span class="number">0.3</span> &#125;
    ];

    <span class="comment">// Create simulation with forces</span>
    this.simulation2 = d3.forceSimulation(nodes2)
        .force(<span class="string">'link'</span>, d3.forceLink(links2)
            .id((d: any) =&gt; d.id)
            .distance((d: any) =&gt; <span class="number">50</span> / d.strength)
            .strength((d: any) =&gt; d.strength))
        .force(<span class="string">'charge'</span>, d3.forceManyBody()
            .strength((d: any) =&gt; -<span class="number">10</span> * d.size))
        .force(<span class="string">'center'</span>, d3.forceCenter(<span class="number">200</span>, <span class="number">120</span>))
        .force(<span class="string">'collision'</span>, d3.forceCollide()
            .radius((d: any) =&gt; d.size + <span class="number">2</span>));

    <span class="keyword">const</span> svg2 = d3.select(<span class="string">'#drag-force'</span>);
    svg2.selectAll(<span class="string">'*'</span>).remove();

    <span class="comment">// Draw links</span>
    <span class="keyword">const</span> link2 = svg2.append(<span class="string">'g'</span>)
        .selectAll(<span class="string">'line'</span>)
        .data(links2)
        .enter().append(<span class="string">'line'</span>)
        .attr(<span class="string">'stroke'</span>, <span class="string">'#999'</span>)
        .attr(<span class="string">'stroke-width'</span>, (d: any) =&gt; Math.sqrt(d.strength * <span class="number">5</span>))
        .attr(<span class="string">'opacity'</span>, <span class="number">0.6</span>);

    <span class="comment">// Draw nodes</span>
    <span class="keyword">const</span> node2 = svg2.append(<span class="string">'g'</span>)
        .selectAll(<span class="string">'circle'</span>)
        .data(nodes2)
        .enter().append(<span class="string">'circle'</span>)
        .attr(<span class="string">'r'</span>, (d: any) =&gt; d.size)
        .attr(<span class="string">'fill'</span>, (d: any) =&gt; d3.schemeCategory10[d.group])
        .attr(<span class="string">'stroke'</span>, <span class="string">'white'</span>)
        .attr(<span class="string">'stroke-width'</span>, <span class="number">2</span>)
        .attr(<span class="string">'cursor'</span>, <span class="string">'pointer'</span>)
        .call(d3.drag&lt;SVGCircleElement, any&gt;()
            .on(<span class="string">'start'</span>, dragstarted)
            .on(<span class="string">'drag'</span>, dragged)
            .on(<span class="string">'end'</span>, dragended));

    <span class="comment">// Labels</span>
    <span class="keyword">const</span> label2 = svg2.append(<span class="string">'g'</span>)
        .selectAll(<span class="string">'text'</span>)
        .data(nodes2)
        .enter().append(<span class="string">'text'</span>)
        .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)
        .attr(<span class="string">'dy'</span>, <span class="number">4</span>)
        .attr(<span class="string">'font-size'</span>, <span class="string">'10px'</span>)
        .attr(<span class="string">'fill'</span>, <span class="string">'white'</span>)
        .attr(<span class="string">'pointer-events'</span>, <span class="string">'none'</span>)
        .text((d: any) =&gt; d.id);

    <span class="comment">// Update positions on tick</span>
    this.simulation2.on(<span class="string">'tick'</span>, () =&gt; &#123;
        link2
            .attr(<span class="string">'x1'</span>, (d: any) =&gt; d.source.x)
            .attr(<span class="string">'y1'</span>, (d: any) =&gt; d.source.y)
            .attr(<span class="string">'x2'</span>, (d: any) =&gt; d.target.x)
            .attr(<span class="string">'y2'</span>, (d: any) =&gt; d.target.y);

        node2
            .attr(<span class="string">'cx'</span>, (d: any) =&gt; d.x)
            .attr(<span class="string">'cy'</span>, (d: any) =&gt; d.y);

        label2
            .attr(<span class="string">'x'</span>, (d: any) =&gt; d.x)
            .attr(<span class="string">'y'</span>, (d: any) =&gt; d.y);
    &#125;);
&#125;
</code></pre>


            <p><strong>Output:</strong> <em>Try dragging the nodes!</em></p>
            <svg id="drag-force" width="500" height="300" class="viz-container"></svg>
            <div class="controls">
                <button class="btn" (click)="restartDragSimulation()">Restart Simulation</button>
                <button class="btn" (click)="toggleForces()">Toggle Forces</button>
            </div>
        </div>

        <!-- 3. Force Types & Configuration -->
        <div class="step">
            <h2>3. Force Types & Configuration — Fine-tuning</h2>
            <p>Explore different force types and their parameters to control network behavior.</p>

         <pre><code>
<span class="keyword">private</span> <span class="keyword">createClusterSimulation</span>() : <span class="keyword">void</span> &#123;
    <span class="keyword">const</span> clusterNodes: Node[] = [];
    <span class="keyword">const</span> clusterLinks: Link[] = [];
    <span class="keyword">const</span> numClusters = <span class="number">3</span>;
    <span class="keyword">const</span> numNodesPerCluster = <span class="number">5</span>;

    <span class="comment">// Generate clustered data</span>
    <span class="keyword">for</span> (<span class="keyword">let</span> cluster = <span class="number">0</span>; cluster &lt; numClusters; cluster++) &#123;
        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; numNodesPerCluster; i++) &#123;
            clusterNodes.push(&#123;
                id: <span class="string">`C$&#123;cluster&#125;-N$&#123;i&#125;`</span>,
                group: cluster,
                cluster: cluster,
                radius: Math.random() * <span class="number">8</span> + <span class="number">5</span>
            &#125;);
        &#125;
    &#125;

    <span class="comment">// Create intra-cluster links</span>
    clusterNodes.forEach((node, i) =&gt; &#123;
        <span class="keyword">if</span> (i % numNodesPerCluster !== <span class="number">0</span>) &#123;
            clusterLinks.push(&#123;
                source: node.id,
                target: clusterNodes[Math.floor(i / numNodesPerCluster) * numNodesPerCluster].id
            &#125;);
        &#125;
    &#125;);

    <span class="keyword">const</span> svg3 = d3.select(<span class="string">'#cluster-force'</span>);
    svg3.selectAll(<span class="string">'*'</span>).remove();

    <span class="comment">// Create simulation with forces</span>
    this.simulation3 = d3.forceSimulation(clusterNodes)
        .force(<span class="string">'link'</span>, d3.forceLink(clusterLinks).id((d: any) =&gt; d.id).distance(<span class="number">30</span>))
        .force(<span class="string">'charge'</span>, d3.forceManyBody().strength(-<span class="number">50</span>))
        .force(<span class="string">'center'</span>, d3.forceCenter(<span class="number">200</span>, <span class="number">120</span>))
        .force(<span class="string">'collision'</span>, d3.forceCollide().radius((d: any) =&gt; d.radius))
        .force(<span class="string">'x'</span>, d3.forceX().strength(<span class="number">0.1</span>))
        .force(<span class="string">'y'</span>, d3.forceY().strength(<span class="number">0.1</span>));

    <span class="comment">// Draw links</span>
    <span class="keyword">const</span> link3 = svg3.append(<span class="string">'g'</span>)
        .selectAll(<span class="string">'line'</span>)
        .data(clusterLinks)
        .enter().append(<span class="string">'line'</span>)
        .attr(<span class="string">'stroke'</span>, <span class="string">'#999'</span>)
        .attr(<span class="string">'stroke-width'</span>, <span class="number">1</span>);

    <span class="comment">// Draw nodes</span>
    <span class="keyword">const</span> node3 = svg3.append(<span class="string">'g'</span>)
        .selectAll(<span class="string">'circle'</span>)
        .data(clusterNodes)
        .enter().append(<span class="string">'circle'</span>)
        .attr(<span class="string">'r'</span>, (d: any) =&gt; d.radius)
        .attr(<span class="string">'fill'</span>, (d: any) =&gt; d3.schemeCategory10[d.cluster])
        .attr(<span class="string">'stroke'</span>, <span class="string">'white'</span>)
        .attr(<span class="string">'stroke-width'</span>, <span class="number">1</span>);

    <span class="comment">// Update positions on tick</span>
    this.simulation3.on(<span class="string">'tick'</span>, () =&gt; &#123;
        link3
            .attr(<span class="string">'x1'</span>, (d: any) =&gt; d.source.x)
            .attr(<span class="string">'y1'</span>, (d: any) =&gt; d.source.y)
            .attr(<span class="string">'x2'</span>, (d: any) =&gt; d.target.x)
            .attr(<span class="string">'y2'</span>, (d: any) =&gt; d.target.y);

        node3
            .attr(<span class="string">'cx'</span>, (d: any) =&gt; d.x)
            .attr(<span class="string">'cy'</span>, (d: any) =&gt; d.y);
    &#125;);
&#125;
</code></pre>


            <p><strong>Output:</strong></p>
            <svg id="cluster-force" width="500" height="240" class="viz-container"></svg>
            <div class="controls">
                <button class="btn" (click)="restartClusterSimulation()">Restart Simulation</button>
                <button class="btn" (click)="addCluster()">Add Cluster</button>
            </div>
        </div>
    </div>
</div>